{"id": "rag_policy_beverages_return_days", "final_answer": 14, "sql": "", "confidence": 0.8, "explanation": "From docs", "citations": ["catalog::chunk1", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "product_policy::chunk0", "product_policy::chunk1"]}
{"id": "hybrid_top_category_qty_summer_2017", "final_answer": {"category": "Confections", "quantity": 18320}, "sql": "SELECT c.CategoryName, SUM(od.Quantity) as TotalQuantity\nFROM \"Order Details\" od\nJOIN Products p ON od.ProductID = p.ProductID\nJOIN Categories c ON p.CategoryID = c.CategoryID\nJOIN Orders o ON od.OrderID = o.OrderID\nWHERE date(o.OrderDate) BETWEEN '2017-06-01' AND '2017-06-30'\nGROUP BY c.CategoryName\nORDER BY TotalQuantity DESC\nLIMIT 1", "confidence": 0.8, "explanation": "From database", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk1", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2", "product_policy::chunk1"]}
{"id": "hybrid_aov_winter_2017", "final_answer": 21018.7, "sql": "SELECT ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID), 2) as AOV\nFROM \"Order Details\" od\nJOIN Orders o ON od.OrderID = o.OrderID\nWHERE date(o.OrderDate) BETWEEN '2017-12-01' AND '2017-12-31'", "confidence": 0.8, "explanation": "From database", "citations": ["Order Details", "Orders", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2", "product_policy::chunk0", "product_policy::chunk1"]}
{"id": "sql_top3_products_by_revenue_alltime", "final_answer": [{"product": "C\u00f4te de Blaye", "revenue": 53265895.23}, {"product": "Th\u00fcringer Rostbratwurst", "revenue": 24623469.23}, {"product": "Mishi Kobe Niku", "revenue": 19423037.5}], "sql": "SELECT p.ProductName, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as Revenue\nFROM \"Order Details\" od\nJOIN Products p ON od.ProductID = p.ProductID\nGROUP BY p.ProductName\nORDER BY Revenue DESC\nLIMIT 3", "confidence": 0.8, "explanation": "From database", "citations": ["Order Details", "Products"]}
{"id": "hybrid_revenue_beverages_summer_2017", "final_answer": 611562.68, "sql": "SELECT ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as Revenue\nFROM \"Order Details\" od\nJOIN Products p ON od.ProductID = p.ProductID\nJOIN Categories c ON p.CategoryID = c.CategoryID\nJOIN Orders o ON od.OrderID = o.OrderID\nWHERE c.CategoryName = 'Beverages'\n  AND date(o.OrderDate) BETWEEN '2017-06-01' AND '2017-06-30'", "confidence": 0.8, "explanation": "From database", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk1", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2", "product_policy::chunk1"]}
{"id": "hybrid_best_customer_margin_2017", "final_answer": {"customer": "Wilman Kala", "margin": 251847.49}, "sql": "SELECT c.CompanyName, ROUND(SUM((od.UnitPrice * 0.3) * od.Quantity * (1 - od.Discount)), 2) as GrossMargin\nFROM \"Order Details\" od\nJOIN Orders o ON od.OrderID = o.OrderID\nJOIN Customers c ON o.CustomerID = c.CustomerID\nWHERE strftime('%Y', o.OrderDate) = '2017'\nGROUP BY c.CompanyName\nORDER BY GrossMargin DESC\nLIMIT 1", "confidence": 0.8, "explanation": "From database", "citations": ["Customers", "Order Details", "Orders", "kpi_definitions::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
